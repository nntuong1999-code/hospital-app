{"ast":null,"code":"'use client';\n\nimport { useRef, useCallback, useEffect } from 'react';\nimport { getPath } from '../../paths/get-path.mjs';\nimport 'klona/full';\nfunction useFormWatch({\n  $status,\n  cascadeUpdates\n}) {\n  const subscribers = useRef({});\n  const watch = useCallback((path, callback) => {\n    useEffect(() => {\n      subscribers.current[path] = subscribers.current[path] || [];\n      subscribers.current[path].push(callback);\n      return () => {\n        subscribers.current[path] = subscribers.current[path].filter(cb => cb !== callback);\n      };\n    }, [callback]);\n  }, []);\n  const getFieldSubscribers = useCallback(path => {\n    const result = subscribers.current[path]?.map(callback => input => callback({\n      previousValue: getPath(path, input.previousValues),\n      value: getPath(path, input.updatedValues),\n      touched: $status.isTouched(path),\n      dirty: $status.isDirty(path)\n    })) ?? [];\n    if (cascadeUpdates) {\n      for (const subscriptionKey in subscribers.current) {\n        if (subscriptionKey.startsWith(`${path}.`) || path.startsWith(`${subscriptionKey}.`)) {\n          result.push(...subscribers.current[subscriptionKey].map(cb => input => cb({\n            previousValue: getPath(subscriptionKey, input.previousValues),\n            value: getPath(subscriptionKey, input.updatedValues),\n            touched: $status.isTouched(subscriptionKey),\n            dirty: $status.isDirty(subscriptionKey)\n          })));\n        }\n      }\n    }\n    return result;\n  }, []);\n  return {\n    subscribers,\n    watch,\n    getFieldSubscribers\n  };\n}\nexport { useFormWatch };","map":{"version":3,"names":["useFormWatch","$status","cascadeUpdates","subscribers","useRef","watch","useCallback","path","callback","useEffect","current","push","filter","cb","getFieldSubscribers","result","map","input","previousValue","getPath","previousValues","value","updatedValues","touched","isTouched","dirty","isDirty","subscriptionKey","startsWith"],"sources":["E:\\HOCCODE\\SMS\\FRONTEND\\hospitalapp\\node_modules\\@mantine\\form\\src\\hooks\\use-form-watch\\use-form-watch.ts"],"sourcesContent":["import { useCallback, useEffect, useRef } from 'react';\nimport { getPath } from '../../paths';\nimport { LooseKeys } from '../../paths.types';\nimport { FormFieldSubscriber, Watch } from '../../types';\nimport { $FormStatus } from '../use-form-status/use-form-status';\nimport { SetValuesSubscriberPayload } from '../use-form-values/use-form-values';\n\ninterface UseFormWatchInput<Values extends Record<string, any>> {\n  $status: $FormStatus<Values>;\n  cascadeUpdates?: boolean;\n}\n\nexport function useFormWatch<Values extends Record<string, any>>({\n  $status,\n  cascadeUpdates,\n}: UseFormWatchInput<Values>) {\n  const subscribers = useRef<Record<LooseKeys<Values>, FormFieldSubscriber<Values, any>[]>>(\n    {} as any\n  );\n\n  const watch: Watch<Values> = useCallback((path, callback) => {\n    useEffect(() => {\n      subscribers.current[path] = subscribers.current[path] || [];\n      subscribers.current[path].push(callback);\n\n      return () => {\n        subscribers.current[path] = subscribers.current[path].filter((cb) => cb !== callback);\n      };\n    }, [callback]);\n  }, []);\n\n  const getFieldSubscribers = useCallback((path: LooseKeys<Values>) => {\n    const result: ((input: SetValuesSubscriberPayload<Values>) => void)[] =\n      subscribers.current[path]?.map(\n        (callback) => (input: SetValuesSubscriberPayload<Values>) =>\n          callback({\n            previousValue: getPath(path, input.previousValues) as any,\n            value: getPath(path, input.updatedValues) as any,\n            touched: $status.isTouched(path),\n            dirty: $status.isDirty(path),\n          })\n      ) ?? [];\n\n    if (cascadeUpdates) {\n      for (const subscriptionKey in subscribers.current) {\n        if (subscriptionKey.startsWith(`${path}.`) || path.startsWith(`${subscriptionKey}.`)) {\n          result.push(\n            ...subscribers.current[subscriptionKey].map(\n              (cb) => (input: SetValuesSubscriberPayload<Values>) =>\n                cb({\n                  previousValue: getPath(subscriptionKey, input.previousValues) as any,\n                  value: getPath(subscriptionKey, input.updatedValues) as any,\n                  touched: $status.isTouched(subscriptionKey),\n                  dirty: $status.isDirty(subscriptionKey),\n                })\n            )\n          );\n        }\n      }\n    }\n\n    return result;\n  }, []);\n\n  return {\n    subscribers,\n    watch,\n    getFieldSubscribers,\n  };\n}\n"],"mappings":";;;;;AAYO,SAASA,aAAiD;EAC/DC,OAAA;EACAC;AACF,GAA8B;EAC5B,MAAMC,WAAA,GAAcC,MAAA,CAClB,EAAC,CACH;EAEA,MAAMC,KAAA,GAAuBC,WAAA,CAAY,CAACC,IAAA,EAAMC,QAAA,KAAa;IAC3DC,SAAA,CAAU,MAAM;MACdN,WAAA,CAAYO,OAAA,CAAQH,IAAI,IAAIJ,WAAA,CAAYO,OAAA,CAAQH,IAAI,KAAK,EAAC;MAC1DJ,WAAA,CAAYO,OAAA,CAAQH,IAAI,EAAEI,IAAA,CAAKH,QAAQ;MAEvC,OAAO,MAAM;QACXL,WAAA,CAAYO,OAAA,CAAQH,IAAI,IAAIJ,WAAA,CAAYO,OAAA,CAAQH,IAAI,EAAEK,MAAA,CAAQC,EAAA,IAAOA,EAAA,KAAOL,QAAQ;MACtF;IACF,GAAG,CAACA,QAAQ,CAAC;EACf,GAAG,EAAE;EAEL,MAAMM,mBAAA,GAAsBR,WAAA,CAAaC,IAAA,IAA4B;IACnE,MAAMQ,MAAA,GACJZ,WAAA,CAAYO,OAAA,CAAQH,IAAI,GAAGS,GAAA,CACxBR,QAAA,IAAcS,KAAA,IACbT,QAAA,CAAS;MACPU,aAAA,EAAeC,OAAA,CAAQZ,IAAA,EAAMU,KAAA,CAAMG,cAAc;MACjDC,KAAA,EAAOF,OAAA,CAAQZ,IAAA,EAAMU,KAAA,CAAMK,aAAa;MACxCC,OAAA,EAAStB,OAAA,CAAQuB,SAAA,CAAUjB,IAAI;MAC/BkB,KAAA,EAAOxB,OAAA,CAAQyB,OAAA,CAAQnB,IAAI;IAAA,CAC5B,MACA,EAAC;IAER,IAAIL,cAAA,EAAgB;MAClB,WAAWyB,eAAA,IAAmBxB,WAAA,CAAYO,OAAA,EAAS;QACjD,IAAIiB,eAAA,CAAgBC,UAAA,CAAW,GAAGrB,IAAI,GAAG,KAAKA,IAAA,CAAKqB,UAAA,CAAW,GAAGD,eAAe,GAAG,GAAG;UACpFZ,MAAA,CAAOJ,IAAA,CACL,GAAGR,WAAA,CAAYO,OAAA,CAAQiB,eAAe,EAAEX,GAAA,CACrCH,EAAA,IAAQI,KAAA,IACPJ,EAAA,CAAG;YACDK,aAAA,EAAeC,OAAA,CAAQQ,eAAA,EAAiBV,KAAA,CAAMG,cAAc;YAC5DC,KAAA,EAAOF,OAAA,CAAQQ,eAAA,EAAiBV,KAAA,CAAMK,aAAa;YACnDC,OAAA,EAAStB,OAAA,CAAQuB,SAAA,CAAUG,eAAe;YAC1CF,KAAA,EAAOxB,OAAA,CAAQyB,OAAA,CAAQC,eAAe;UAAA,CACvC,EACL,CACF;QACF;MACF;IACF;IAEA,OAAOZ,MAAA;EACT,GAAG,EAAE;EAEL,OAAO;IACLZ,WAAA;IACAE,KAAA;IACAS;EAAA,CACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}